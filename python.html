<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=VT323&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/general.css" />
    <title>Python(MicroPython)</title>
  </head>

  <body>
    <div id="container">
      <div id="navBar">
        <a href="index.html">O mnie</a>
        <a href="c++.html">C++</a>
        <a href="python.html">Python (MicroPython)</a>
        <a href="javascript.html">JavaScript</a>
        <a href="typescript.html">TypeScript</a>
      </div>
      <div id="projectsSettings">
        <h3 id="heading">
          Sterowanie wiatami oraz alarmem w gara偶u na mikrokontrolerze
          Raspberry Pi Pico W
        </h3>

        <p>
          W tym artykule przedstawi projekt zainstalowany na mikrokontolerze
          Raspberry Pi Pico W, oraz zosta napisany w MicroPython'nie(Python).
          <br />
          Zao偶eniem byo, aby:
          <br />
          <br />
          - Jeli alarm jest aktywny:
          <br />
          Po otworzeniu bramy gara偶owej czujnik ruchu ma wykry ruch oraz
          aktywowa alarm, w tym przypadku, sygna wietlny oraz d藕wikowy.
          <br />
          <br />
          - Jeli alarm jest dezaktywowany(zielona dioda powinna si wieci):
          <br />
          Po otworzeniu bramy gara偶owej czujnik ruchu ma wykry ruch oraz
          zapali g贸wn lamp(lampa jest r贸wnie偶 podpita pod sygna wietlny z
          alarmu). R贸wnie偶 w panelu operatorskim znajduj si 2 przyciski do
          wczenia/wyczenia lamp na 2 stanowiskach - ka偶dy przycisk odpowiada
          danemu stanowisku, np. przycisk 1 odpowiada stanowisku nr. 1.
          <br />
          <br />
          Aby aktywowa alarm lub dezaktywowa alarm trzeba wcisn przycisk od
          aktywacji alarmu.
          <br />
          <br />
          Ponadto do pytki mikrokontolera jest zamocowany wentylator, kt贸ry
          spenia funkcj chodzenia. W przypadku jeli tempertura
          mikrokontolera jest wiksza lub r贸wna 35 stopni Celcjusza to wtedy
          wentylator si zacza, jeli wentylator schodzi pytk do
          temperatury mniejszej lub r贸wnej 27 stopni Celcjusza, wtedy ukad
          chodzenia zostanie wyczony.
          <br />
          <br />
          Ponie偶ej przedstawiam fragmenty kodu z opisem:
          <br />
          <img src="/photo/python/photo.png" alt="photo" />
          <br />
          W 1 lini kodu importuj bibliotek "uasyncio", jest to biblioteka
          asynchronicznego we/wy w MicroPythonie. Zapewnia narzdzia do
          programowania asynchronicznego za pomoc korutyn i ptli zdarze.
          <br />
          <br />

          W 2 linii kodu importuj bibliotek "machine", biblioteka ta umo偶liwia
          dostp do funkcji zwizanych z obsug sprztu na pytce z
          MicroPythonem. Obejmuje kontrol pin贸w (GPIO), przetwarzanie
          analogowo-cyfrowe (ADC), modulacj PWM (szeroko impulsu), oraz inne
          funkcje zwizane z obsug sprztu.
          <br />
          <br />
          W liniach 5-11 zostay zdefiniowane obiekty reprezentujce odpowiedni
          piny wejciowe i wyjiowe oraz zmienna, kt贸re bd u偶ywane z
          czujnikiem ruchu.
          <br />
          <br />
          # Motion sensor
          <br />
           linia 5: "alarm_led = Pin(28, Pin.OUT)" - do Pinu wyjciowego 28
          zostaa przypisana dioda, kt贸ra po wykryciu ruchu (jeli alarm jest
          aktywny) zacznie mruga.
          <br />
           linia 6: "alarm_is_deactivated = Pin(27, Pin.OUT)" - do Pinu
          wyjciowego 27 zostaa przypisana dioda, kt贸ra sygnalizuje czy alarm
          jest dezaktywowany (jeli dezaktywowany wieci na zielono).
          <br />
           linia 7: "led = Pin(26, Pin.OUT)" - do Pinu wyjciowego 26 zostaa
          przypisana lampa, kt贸ra w przypadku wykrycia ruchu (jeli alarm jest
          aktywny) zacznie mruga.
          <br />
           linia 8: "motion_sensor = Pin(2, Pin.IN, Pin.PULL_UP)" - do Pinu
          wejciowego zosta przypisany czujnik ruchu, kt贸ry daje sygan 0
          (niski) lub 1 (wysoki).
          <br />
           linia 9: "alarm = Pin(14, Pin.OUT)" - do Pinu wyjciowego 14 zosta
          przypisany sygna d藕wikowy alarmu.
          <br />
           linia 10: "button_active_alarm = Pin(14, Pin.IN, Pin.PULL_UP)" - do
          Pinu wejciowego zosta przypisany przycisk, kt贸ry aktywuje alarm.
          <br />
           linia 11: "activation_alarm = False" - jest to zmienna, kt贸ra
          przechowuje wartoc logiczn True lub False.
          <br />
          <br />
          W liniach 14-17 zostay zdefiniowane obiekty reprezentujce Piny
          wejsciowe i wyjciowe do obsugi lamp gara偶u w odpowienich
          stanowiskach.
          <br />
          <br />
          # Lamps
          <br />
           linia 14: "lamp1 = Pin(19, Pin.OUT)" - do Pinu wyjciowego 19
          zostaa przypisana lampa, kt贸ra znajduje si na stanowisku nr. 1.
          <br />
           linia 15: "lamp2 = Pin(18, Pin.OUT)" - do Pinu wyjciowego 18
          zostaa przypisana lampa, kt贸ra znajduje si na stanowisku nr. 2.
          <br />
           linia 16: "button_lamp1 = Pin(13, Pin.IN, Pin.PULL_UP)" - do Pinu
          wejciowego 13 zostaa przypisny przycisk od wcznia lamp ze
          stanowiska nr. 1.
          <br />
           linia 17: "button_lamp2 = Pin(12, Pin.IN, Pin.PULL_UP)" - do Pinu
          wejciowego 12 zostaa przypisny przycisk od wcznia lamp ze
          stanowiska nr. 2.
          <br />
          <br />
          W liniach 20-22 zostay zdefiniowane obiekty do odczytu temperatury z
          mikrokontolera Raspberry Pi Pico W.
          <br />
          <br />
           linia 20: "sensor_temp = ADC(4)" - do Pinu 4 zosta przypisany
          czujnik temperatury z mikrokontolera.
          <br />
           linia 21: "conversion_factor = 3.3 / 65535" - ten kod oblicza
          warto przelicznika, kt贸ry jest u偶ywany do przeksztacenia wynik贸w
          pomiaru ADC na wartoci napicia. Poniewa偶 wynik ADC jest liczb
          cakowit od 0 do 65535, dzielenie przez 65535 przelicza t liczb na
          zakres wartoci od 0 do 3.3V, co pozwala na konwersj na odpowiednie
          wartoci napicia.
          <br />
           linia 22: "fan = Pin(0, Pin.OUT)" - do 0 Pinu wyjciowego zosta
          przypisany wentylator penicy funkcj chodzenia mikrokontolera.
          <br />
          <br />
          <img src="/photo/python/photo2.png" alt="photo2" />
          <br />
          <br />
          W liniach 25-31 zostaa przedstawiona funkcja asynchroniczna
          "active_alarm()", w kt贸rej wykonuje si ptla while, ma ona za zadnie
          zmienia stan zmiennej "activation_alarm" z False na True i na odwr贸t
          po wciniciu przycisku "button_active_alarm".
          <br />
          <br />
          <img src="/photo/python/photo3.png" alt="photo3" />
          <br />
          <br />
          W liniach 33-65 zostaa zdefiniowana funkcja asynchroniczna "main()",
          w kt贸rej wykonuje si ptla while. Ma ona za zadanie wczy/wyczy
          alarm, aktywowa alarm, dezaktywowa alarm, wczy/wyczy lamp w
          zale偶noci od spenionych warunk贸w.
          <br />
          <br />
          W ptli znajduj si instrukcja warunkowa, w kt贸rej zagnie偶d偶ona jest
          naspna instrukcja warunkowa.
          <br />
           w linii 35: "if motion_sensor.value() == 1:" - czujnik ruchu bdzie
          mie stan wysoki (1) czyli wykryje ruch.
          <br />
           w liniach 37-43: "if activation_alarm:" - jeli czujnik ruchu poda
          sygna 1, oraz alarm jest zaczony to wtedy w konsoli wypisze nam
          "print("Alarm is on")", zacznie mruga dioda "alarm_led.toggle()",
          zielona dioda "alarm_is_deactivated.value(0)" zganie, oraz zostanie
          wczony sygna d藕wikowy "alarm.toggle()". Wszystko wykonuje si 20
          razy za pomoc ptli for.
          <br />
           w liniach 45-49: jeli alarm jest dezaktywowany, a czujnik ruchu
          poda sygna 1 to wtedy, w konsoli wypisze nam "print("Lamps is on")",
          dioda od alarmu si zawieci "alarm_is_deactivated.value(1)" oraz
          zawieci si lampa "led.value(1)".
          <br />
           w liniach 51-57: "elif activation_alarm:" - jeli alarm jest
          aktywny ale czunik ruchu podaje stan 0 to wtedy wypisuje nam w konsoli
          "print("Alarm is on, waiting for move")",dioda od aktywacji alarmu
          jest wyczona "alarm_is_deactivated.value(0)", lampa od wykrycia
          ruchu jest wyczona "led.value(0)", dioda alarmu jest wyczony
          "led.value(0)", sygna d藕wikowy jest wyczony "alarm.value(0)".
          <br />
           w liniach 59-65: jeli alarm jest nie aktywny a czujnik ruchu
          podaje stan 0 to wtedy w konsoli wywietla si "print("Waiting for
          move")", dioda od aktywacji alarmu si wieci
          "alarm_is_deactivated.value(1)", lampa jest wyczona "led.value(0)",
          lampa "led.value(0)" jest wyczona, dioda od alarmu jest wyaczona
          "alarm_led.value(0)", sygna d藕wikowy jest wyczony
          "alarm.value(0)".
          <br />
          <br />
          <img src="/photo/python/photo4.png" alt="photo4" />
          <br />
          <br />
          W liniach 68-81 zostaa zdefiniowana funkcja asynchroniczna
          "turn_on_lamps()", kt贸ra ma za zadanie wczy lub wyczy lampy
          znajdujce si nad stanowiskiem 1 lub 2.
          <br />
          <br />
           w liniach 69-70: "lamp1_state = False", "lamp2_state = False" -
          zdefiniowane s zmienne od lamp z 1 i 2 stanowiska z domyln
          wartoci False.
          <br />
           w liniach 74-81: "if button_lamp1.value() == 0:" - jeli wciniemy
          przycisk "button_lamp1" to wtedy zmieni si stan lampy "lamp1_state" z
          False na True oraz jeli stan lampy "lamp1_state" jest r贸wne True to
          wtedy poda sygna 1 na "lamp1" a jeli stan bdzie r贸wny False to poda
          sygna 0 na lamp - odpowiada temu linia 76 "lamp1.value(1 if
          lamp1_state else 0)".
          <br />
          W liniach 78-81 dziej si dokadnie to samo tylko odpowiada to lampie
          ze stanowiska nr. 2.
          <br />
          <br />
          <img src="/photo/python/photo5.png" alt="photo5" />
          <br />
          <br />
          W liniach 83-95 zdefiniowana zostaa funkcja asynchroniczna
          "temperature_sensor()". Funkcja ta odczytuje temperatur z czujnika w
          mikrokontrolerze i w zale偶noci od tego jaka jest aktualna temperatura
          to wcza lub wycza wentylator "fan".
          <br />
          <br />
           w linii 86: "reading = sensor_temp.read_u16() * conversion_factor"
          - ta linia odczytuje warto z czujnika temperatury, czyli odczytuje
          warto cyfrow (liczb cakowit) z przetwornika ADC.
          sensor_temp.read_u16() wykonuje odczyt i zwraca wynik jako liczba
          cakowita 16-bitowa. Nastpnie ta warto jest przeliczana na warto
          napicia, korzystajc z conversion_factor.
          <br />
           w linii 87: "temperature = 27 - (reading - 0.706) / 0.01721" - w
          tej linii obliczana jest temperatura na podstawie wartoci napicia
          odczytanej z czujnika temperatury. Warto 0.706 i 0.01721 to wartoci
          kalibracyjne, kt贸re zostay dostosowane do konkretnego czujnika.
          <br />
           w linii 88: "temperature_rounded = round(temperature, 1)" - wynik
          obliczonej temperatury zostaje zaokrglony do jednego miejsca po
          przecinku i zapisany do zmiennej temperature_rounded.
          <br />
           w linii 89: "print(f"Temperature: {temperature_rounded} 掳C")" - w
          konsoli zostaje wypisana aktualna temperatura z mikrokontolera.
          <br />
           w linii 90: "if temperature_rounded >= 35:" - jeli zostanie
          speniony warunek, 偶e temperatura jest wiksza lub r贸wna 35 stopni
          Celcjusz to wykona si ten warunek.
          <br />
           w linii 91: "fan.value(1)" - wentylator zostanie wczony.
          <br />
           w linii 92: "print("The temperature is too high, fan is on")" - w
          konsoli zostanie wypisane "The temperature is too high, fan is on".
          <br />
           w linii 93: "elif temperature_rounded <= 27:" - jeli zostanie
          speniony warunek, 偶e temperatura jest mniejsza lub r贸wna 27 to wtedy
          wykona si warunek.
          <br />
           w linii 94: "fan.value(0)" - wentylator zostanie wyczony.
          <br />
          <br />
          <img src="/photo/python/photo6.png" alt="photo6" />
          <br />
          <br />
           w linii 98: "async def run_tasks():" - zostaje zdefiniowana funkcja
          asynchroniczna o nazawie "run_tasks()".
          <br />
           w linii 99: "await asyncio.gather(active_alarm(), main(),
          turn_on_lamps(), temperature_sensor())" -tutaj u偶ywamy funkcji
          "asyncio.gather()" do uruchomienia wielu asynchronicznych zada
          jednoczenie. Wewntrz "gather()" podajemy list funkcji, kt贸re chcemy
          uruchomi asynchronicznie.
          <br />
           w linii 101: "asyncio.run(run_tasks())" - ta linia rozpoczyna
          wykonanie asynchronicznego zadania o nazwie "run_tasks()" za pomoc
          "asyncio.run()".
          <br />
          <br />
          Jeli chcesz odwiedzi ten projekt zapraszam na GitHub'a gdzie mo偶na
          zobaczy jak wyglda kod.
        </p>
      </div>
      <div id="foother">
        <span
          ><i
            >Strona internetowa zostaa stworzona z u偶yciem HTML, CSS oraz
            TypeScript</i
          ></span
        >
      </div>
    </div>
  </body>
</html>
